---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by likai.
--- DateTime: 2023/3/6 10:23
--- 游戏控制台
---@class ConsoleView:LuaObj
---@field New fun():ConsoleView
local ConsoleView = class("ConsoleView", LuaObj)

function ConsoleView.ShowOrHide()
    if not ConsoleView.instance then
        ConsoleView.instance = ConsoleView.New()
    end
    if ConsoleView.instance.gameObject.activeSelf == false then
        ConsoleView.instance:Show()
    else
        ConsoleView.instance:Hide()
    end
end

function ConsoleView:Ctor()
    --print("Login:Ctor")
    ConsoleView.super.Ctor(self, "Prefabs/Console/ConsoleView.prefab", nil, Constants.LAYER_TOP)
    self.btnsTran = self.transform:Find("AddBtns")

    AddButtonHandler(self.transform:Find("ExitBtn").gameObject, PointerHandler.CLICK, happyCall(self, self.ExitHandler))
    AddButtonHandler(self.transform:Find("StoryListBtn").gameObject, PointerHandler.CLICK, happyCall(self, self.OpenStoryListHandler))
    AddButtonHandler(self.transform:Find("CloseBtn").gameObject, PointerHandler.CLICK, happyCall(self, self.CloseHandler))
    self:Hide()
end

function ConsoleView:AddBtn(lbText, ClickFunc)
    local btn = CreatePrefab("Prefabs/Console/Button.prefab", self.btnsTran)
    GetComponent.TextMeshProUGUI(btn.transform:Find("lb").gameObject).text = lbText
    AddButtonHandler(btn, PointerHandler.CLICK, ClickFunc)
    return btn
end
function ConsoleView:AddInputField(defaultText)
    local input = CreatePrefab("Prefabs/Console/InputField.prefab", self.btnsTran)
    GetComponent.TMP_InputField(input).text = defaultText
    return input
end
function ConsoleView:AddText(text)
    local lb = CreatePrefab("Prefabs/Console/Text.prefab", self.btnsTran)
    GetComponent.TextMeshProUGUI(lb).text = text
    return lb
end
function ConsoleView:AddEmpty()
    return CreatePrefab("Prefabs/Console/Empty.prefab", self.btnsTran)
end

function ConsoleView:OpenStoryListHandler()
    if not self.storyList then
        self.storyList = require("Module.Common.View.StoryListView").New(self.transform)
    end
    self.storyList:Show()
end

function ConsoleView:ExitHandler()
    self:Hide()
    Game.Relaunch()
end

function ConsoleView:CloseHandler()
    self:Hide()
end

function ConsoleView:Show()
    ConsoleView.super.Show(self)
    self.transform:SetAsLastSibling()

end
function ConsoleView:Hide()
    if self.storyList then
        self.storyList:Hide()
    end
    ConsoleView.super.Hide(self)
end
return ConsoleView